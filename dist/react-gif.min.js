!function(root,factory){"object"==typeof exports&&"object"==typeof module?module.exports=factory(require("React")):"function"==typeof define&&define.amd?define(["React"],factory):"object"==typeof exports?exports.Gif=factory(require("React")):root.Gif=factory(root.React)}(this,function(__WEBPACK_EXTERNAL_MODULE_2__){return function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="",__webpack_require__(0)}([function(module,exports,__webpack_require__){"use strict";module.exports=__webpack_require__(1)},function(module,exports,__webpack_require__){"use strict";function merge(a,b){var object={};return Object.keys(a).forEach(function(key){object[key]=a[key]}),Object.keys(b).forEach(function(key){object[key]=b[key]}),object}var React=__webpack_require__(2),Exploder=__webpack_require__(3);module.exports=React.createClass({displayName:"Gif",getDefaultProps:function(){return{pingPong:!1,reverse:!1,speed:1}},getInitialState:function(){return{currentFrame:0,offset:0,stopped:!1}},componentDidMount:function(){this.props.src&&this.explode(this.props.src)},componentDidUpdate:function(prevProps,prevState){prevState.stopped===!0&&this.state.stopped===!1&&this.animationLoop(),prevState.startTime!==this.state.startTime&&this.animationLoop&&this.animationLoop()},componentWillReceiveProps:function(nextProps){this.props.src!==nextProps.src&&this.explode(nextProps.src),!this.props.play&&nextProps.play&&this.start(),!this.props.stop&&nextProps.stop&&this.stop(),!this.props.pause&&nextProps.pause&&this.pause()},explode:function(url){var _this=this,exploder=new Exploder(url);exploder.load().then(function(gif){_this.gif=gif,_this.setState(gif),_this.startSpeed(),_this.start()})},startSpeed:function(){var _this2=this;this.animationLoop=function(){var gifLength=10*_this2.state.length/_this2.props.speed,duration=performance.now()-_this2.state.startTime+_this2.state.offset,repeatCount=duration/gifLength,fraction=repeatCount%1;return _this2.props.reverse&&(fraction=1-fraction),_this2.state.stopped||repeatCount>=_this2.props.times?void _this2.setState({currentFrame:_this2.gif.frameAt(0)}):(_this2.setState({currentFrame:_this2.gif.frameAt(_this2.props.pingPong&&repeatCount%2>=1?1-fraction:fraction)}),void requestAnimationFrame(_this2.animationLoop))}},start:function(){var startTime=performance.now();this.setState({startTime:startTime,stopped:!1})},pause:function(){var offset=performance.now()-this.state.startTime+this.state.offset;this.setState({offset:offset,stopped:!0})},stop:function(){this.setState({offset:0,stopped:!0})},render:function(){var _this3=this,framesStyle={display:"block",position:"relative"},frameStyle={position:"absolute",top:0,left:0,WebkitTransform:"translateZ(0)",msTransform:"translateZ(0)",transform:"translateZ(0)"},frames=this.state.frames?this.state.frames.map(function(frame,index){var show=_this3.state.currentFrame>=index?1:0,style=merge(frameStyle,{opacity:show});return 0===index&&(style=merge(style,{position:"static"})),React.createElement("img",{src:frame.url,className:"frame",style:style})}):null;return React.createElement("div",{className:"frames",style:framesStyle},frames)}})},function(module){module.exports=__WEBPACK_EXTERNAL_MODULE_2__},function(module,exports,__webpack_require__){"use strict";module.exports=__webpack_require__(4)},function(module,exports,__webpack_require__){"use strict";var _prototypeProperties=function(child,staticProps,instanceProps){staticProps&&Object.defineProperties(child,staticProps),instanceProps&&Object.defineProperties(child.prototype,instanceProps)},_interopRequire=function(obj){return obj&&(obj["default"]||obj)},Gif=_interopRequire(__webpack_require__(5)),StreamReader=_interopRequire(__webpack_require__(6)),Promises=__webpack_require__(7).Promises,url=URL&&URL.createObjectURL?URL:webkitURL,gifCache=new Map,Exploder=function(){function Exploder(file){this.file=file}return _prototypeProperties(Exploder,null,{load:{value:function(){var _this=this,cachedGifPromise=gifCache.get(this.file);if(cachedGifPromise)return cachedGifPromise;var gifPromise=Promises.xhrGet(this.file,"*/*","arraybuffer").then(function(buffer){return _this.explode(buffer)});return gifCache.set(this.file,gifPromise),gifPromise},writable:!0,enumerable:!0,configurable:!0},explode:{value:function(buffer){return console.debug("EXPLODING "+this.file),new Promise(function(resolve,reject){var frames=[],streamReader=new StreamReader(buffer);if("GIF89a"!=streamReader.readAscii(6))return void reject(Error("Not a GIF!"));if(streamReader.skipBytes(4),streamReader.peekBit(1)){streamReader.log("GLOBAL COLOR TABLE");var colorTableSize=7&streamReader.readByte();streamReader.log("GLOBAL COLOR TABLE IS "+3*Math.pow(2,colorTableSize+1)+" BYTES"),streamReader.skipBytes(2),streamReader.skipBytes(3*Math.pow(2,colorTableSize+1))}else streamReader.log("NO GLOBAL COLOR TABLE");for(var gifHeader=buffer.slice(0,streamReader.index),spinning=!0,expectingImage=!1;spinning;)if(streamReader.isNext([33,255])){streamReader.log("APPLICATION EXTENSION"),streamReader.skipBytes(2);var blockSize=streamReader.readByte();if(streamReader.log(streamReader.readAscii(blockSize)),streamReader.isNext([3,1]))streamReader.skipBytes(5);else{for(streamReader.log("A weird application extension. Skip until we have 2 NULL bytes");0!==streamReader.readByte()||0!==streamReader.peekByte(););streamReader.log("OK moving on"),streamReader.skipBytes(1)}}else if(streamReader.isNext([33,254])){for(streamReader.log("COMMENT EXTENSION"),streamReader.skipBytes(2);!streamReader.isNext([0]);){var blockSize=streamReader.readByte();streamReader.log(streamReader.readAscii(blockSize))}streamReader.skipBytes(1)}else if(streamReader.isNext([44])){if(streamReader.log("IMAGE DESCRIPTOR!"),expectingImage||frames.push({index:streamReader.index,delay:0}),expectingImage=!1,streamReader.skipBytes(9),streamReader.peekBit(1)){streamReader.log("LOCAL COLOR TABLE");var colorTableSize=7&streamReader.readByte();streamReader.log("LOCAL COLOR TABLE IS "+3*Math.pow(2,colorTableSize+1)+" BYTES"),streamReader.skipBytes(3*Math.pow(2,colorTableSize+1))}else streamReader.log("NO LOCAL TABLE PHEW"),streamReader.skipBytes(1);for(streamReader.log("MIN CODE SIZE "+streamReader.readByte()),streamReader.log("DATA START");!streamReader.isNext([0]);){var blockSize=streamReader.readByte();streamReader.skipBytes(blockSize)}streamReader.log("DATA END"),streamReader.skipBytes(1)}else if(streamReader.isNext([33,249,4])){streamReader.log("GRAPHICS CONTROL EXTENSION!");var index=streamReader.index;streamReader.skipBytes(3);var disposalMethod=streamReader.readByte()>>2;streamReader.log("DISPOSAL "+disposalMethod);var delay=streamReader.readByte()+256*streamReader.readByte();frames.push({index:index,delay:delay,disposal:disposalMethod}),streamReader.log("FRAME DELAY "+delay),streamReader.skipBytes(2),expectingImage=!0}else{for(var maybeTheEnd=streamReader.index;!streamReader.finished()&&!streamReader.isNext([33,249,4]);)streamReader.readByte();streamReader.finished()?(streamReader.index=maybeTheEnd,streamReader.log("WE END"),spinning=!1):streamReader.log("UNKNOWN DATA FROM "+maybeTheEnd)}for(var endOfFrames=streamReader.index,gifFooter=buffer.slice(-1),i=0;i<frames.length;i++){var frame=frames[i],nextIndex=i<frames.length-1?frames[i+1].index:endOfFrames;frame.blob=new Blob([gifHeader,buffer.slice(frame.index,nextIndex),gifFooter],{type:"image/gif"}),frame.url=url.createObjectURL(frame.blob)}resolve(new Gif(frames))})},writable:!0,enumerable:!0,configurable:!0}}),Exploder}();module.exports=Exploder},function(module){"use strict";var _prototypeProperties=function(child,staticProps,instanceProps){staticProps&&Object.defineProperties(child,staticProps),instanceProps&&Object.defineProperties(child.prototype,instanceProps)},defaultFrameDelay=10,Gif=function(){function Gif(frames){var _this=this;this.frames=frames,this.length=0,this.offsets=[],frames.forEach(function(frame){_this.offsets.push(_this.length),_this.length+=frame.delay||defaultFrameDelay})}return _prototypeProperties(Gif,null,{frameAt:{value:function(fraction){for(var offset=fraction*this.length,i=1,l=this.offsets.length;l>i&&!(this.offsets[i]>offset);i++);return i-1},writable:!0,enumerable:!0,configurable:!0}}),Gif}();module.exports=Gif},function(module){"use strict";var _prototypeProperties=function(child,staticProps,instanceProps){staticProps&&Object.defineProperties(child,staticProps),instanceProps&&Object.defineProperties(child.prototype,instanceProps)},StreamReader=function(){function StreamReader(arrayBuffer){this.data=new Uint8Array(arrayBuffer),this.index=0,this.log("TOTAL LENGTH: "+this.data.length)}return _prototypeProperties(StreamReader,null,{finished:{value:function(){return this.index>=this.data.length},writable:!0,enumerable:!0,configurable:!0},readByte:{value:function(){return this.data[this.index++]},writable:!0,enumerable:!0,configurable:!0},peekByte:{value:function(){return this.data[this.index]},writable:!0,enumerable:!0,configurable:!0},skipBytes:{value:function(n){this.index+=n},writable:!0,enumerable:!0,configurable:!0},peekBit:{value:function(i){return!!(this.peekByte()&1<<8-i)},writable:!0,enumerable:!0,configurable:!0},readAscii:{value:function(n){for(var s="",i=0;n>i;i++)s+=String.fromCharCode(this.readByte());return s},writable:!0,enumerable:!0,configurable:!0},isNext:{value:function(array){for(var i=0;i<array.length;i++)if(array[i]!==this.data[this.index+i])return!1;return!0},writable:!0,enumerable:!0,configurable:!0},log:{value:function(){},writable:!0,enumerable:!0,configurable:!0},error:{value:function(str){console.error(this.index+": "+str)},writable:!0,enumerable:!0,configurable:!0}}),StreamReader}();module.exports=StreamReader},function(module,exports){"use strict";exports.Promises={xhrGet:function(url,accept,responseType){return new Promise(function(resolve,reject){var loader=new XMLHttpRequest;loader.open("GET",url,!0),loader.setRequestHeader("Accept",accept),loader.responseType=responseType,loader.onload=function(){200==this.status?resolve(this.response):reject(Error(this.statusText))},loader.onerror=function(){reject(Error("Network Error"))},loader.send()})}}}])});
//# sourceMappingURL=react-gif.min.map